{%extends 'base.html'%}

{% load bootstrap %}

{%block content%}

	{%if UltimaEvidenciasPrevia.nombre == "Validación de la calidad del agua" and UltimaEvidenciasPrevia.aprobacion_imta == "No aprobado" %}

		<div class="jumbotron">
			<h1 class="display-3">Aviso</h1>
			<p class="lead">Por cuestiones XXXXXXX no se podrá instalar el bebedero</p>
		</div>

	{%else%}

		{%if request.user.perfil.tipo != "Escuela"%}

			<h2>Información de la Escuela {{perfil.nivel_educativo}} {{escuela.get_full_name}}</h2>

			<p>CCT: {{escuela.username}}</p>
			<p>Turno: {{perfil.turno}}</p>
			<p>Director: {{perfil.director}}</p>
			{%if perfil.foto_director%}
			<p>Foto del director: <a href="{{perfil.foto_director.url}}">Ver</a></p>
			{%endif%}
			<p>Cantidad de alumnos: {{perfil.plantilla_escolar}}</p>
			<p>Telefono: {{perfil.telefono}}</p>
			<p>Domicilio: {{perfil.domicilio}}</p>
			<p>Referencias: {{perfil.referencias}}</p>
			<p>Aulas en uso: {{perfil.aulas_en_uso}}</p>
			<p>Aulas existentes: {{perfil.aulas_existentes}}</p>
			<p>Clave interna: {{perfil.clave}}</p>

		{%endif%}

		<h2>Información del Sistema bebedero</h2>
		<p>Conexión: {{perfil.conexion}}</p>
		<p>Numero identificador del mueble: {{sistemabebedero.identificador}}</p>
		<p>Mueble: {{sistemabebedero.mueble}}</p>
		<p>Filtro: {{sistemabebedero.filtro}}</p>
		<p>Constructora: {{sistemabebedero.constructora}}</p>
		<p>Modulo: {{sistemabebedero.modulo}}</p>

		<h2>Historial de evidencias</h2>
		<h3>Previas a la instalación</h3>
		<div class="table-responsive">

			<table class="table">
				<thead>
					<th>Id</th>
					<th>Nombre</th>
					<th>Documento</th>
					<th>Foto</th>
					<th>Video</th>
					<th>Fecha de creación</th>
					<th>Aprobado</th>
					<th>Subido por</th>
				</thead>
				<tbody>

			{%for evidencia in evidenciasPrevias%}

					<tr>
						<td>{{evidencia.pk}}</td>
						<td>{{evidencia.nombre}}</td>
						<td><a href="/media/{{evidencia.archivo}}">Ver</a></td>
						<td><a href="/media/{{evidencia.foto}}">Ver</a></td>
						<td><a href="/media/{{evidencia.video}}">Ver</a></td>
						<td>{{evidencia.creacion}}</td>
						<td>{%if evidencia.aprobado is True%}<i class="fa fa-check" aria-hidden="true"></i>{%else%}<i class="fa fa-close fa-2x" aria-hidden="true"></i>{%endif%}</td>
						<td>{{evidencia.subido_por}}</td>
					</tr>

			{%empty%}

					<tr>
						<td colspan="8">No se han registrado evidencias</td>
					</tr>

			{%endfor%}

				</tbody>
			</table>
		</div>

		{%if UltimaEvidenciaPrevia.nombre == "Validación de la calidad del agua" and UltimaEvidenciaPrevia.aprobado is True %}

			<h3>Durante a la instalación</h3>

			<div class="table-responsive">
				<table class="table">
					<thead>
						<th>Id</th>
						<th>Nombre</th>
						<th>Documento</th>
						<th>Foto</th>
						<th>Video</th>
						<th>Fecha de creación</th>
						<th>Aprobado</th>
						<th>Subido por</th>
					</thead>
					<tbody>

			{%for evidencia in evidenciasInstalacion%}

						<tr>
							<td>{{evidencia.pk}}</td>
							<td>{{evidencia.nombre}}</td>
							<td><a href="/media/{{evidencia.archivo}}">Ver</a></td>
							<td><a href="/media/{{evidencia.foto}}">Ver</a></td>
							<td><a href="/media/{{evidencia.video}}">Ver</a></td>
							<td>{{evidencia.creacion}}</td>
							<td>{%if evidencia.aprobado is True%}<i class="fa fa-check" aria-hidden="true"></i>{%else%}<i class="fa fa-close fa-2x" aria-hidden="true"></i>{%endif%}</td>
							<td>{{evidencia.subido_por}}</td>
						</tr>

			{%empty%}

						<tr>
							<td colspan="8">No se han registrado evidencias</td>
						</tr>

			{%endfor%}

					</tbody>
				</table>
			</div>

			{%if UltimaEvidenciaInstalacion.nombre == "Constancia de realización de la fase: Bebedero" and UltimaEvidenciaInstalacion.aprobado is True %}

				<h3>Durante a la instalación</h3>

				<div class="table-responsive">
					<table class="table">
						<thead>
							<th>Id</th>
							<th>Nombre</th>
							<th>Documento</th>
							<th>Foto</th>
							<th>Video</th>
							<th>Fecha de creación</th>
							<th>Aprobado</th>
							<th>Subido por</th>
						</thead>
						<tbody>

				{%for evidencia in evidenciasPostInstalacion%}

							<tr>
								<td>{{evidencia.pk}}</td>
								<td>{{evidencia.nombre}}</td>
								<td><a href="/media/{{evidencia.archivo}}">Ver</a></td>
								<td><a href="/media/{{evidencia.foto}}">Ver</a></td>
								<td><a href="/media/{{evidencia.video}}">Ver</a></td>
								<td>{{evidencia.creacion}}</td>
								<td>{%if evidencia.aprobado is True%}<i class="fa fa-check" aria-hidden="true"></i>{%else%}<i class="fa fa-close fa-2x" aria-hidden="true"></i>{%endif%}</td>
								<td>{{evidencia.subido_por}}</td>
							</tr>

				{%empty%}

							<tr>
								<td colspan="8">No se han registrado evidencias</td>
							</tr>

				{%endfor%}

						</tbody>
					</table>
				</div>

				<div class="well">
					<form action="." method="post" enctype="multipart/form-data">
						<h3>Crea una evidencia durante la instalación</h3>
						{%csrf_token%}
						{{NuevaEvidenciaForm3 | bootstrap}}
						<input type="submit" value="Crear">
					</form>
				</div>

			{%else%}

				<div class="well">
					<form action="." method="post" enctype="multipart/form-data">
						<h3>Crea una evidencia durante la instalación</h3>
						{%csrf_token%}
						{{NuevaEvidenciaForm2 | bootstrap}}
						<input type="submit" value="Crear">
					</form>
				</div>


			{%endif%}




			{%else%}
			<div class="well">
				<form action="." method="post" enctype="multipart/form-data">
					<h3>Crea una evidencia previa a la instalación</h3>
					{%csrf_token%}
					{{NuevaEvidenciaForm | bootstrap}}
					<input type="submit" value="Registrar">
				</form>
			</div>

		{%endif%}

	{%endif%}















































{%endblock content%}