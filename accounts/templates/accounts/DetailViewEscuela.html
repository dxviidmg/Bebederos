{%extends 'base.html'%}

{%load bootstrap%}

{%block content%}

	<h1>Información de la institución</h1>

	<p><a href="{%url 'accounts:ListViewEscuelas' municipio.pk%}">Regresar</a></p>

	<!--Tabla de Información de la escuela-->
	<div class="row justify-content-center">
		<div class="table-responsive text-center">
			<table class="table table-bordered">
				<thead>
					<tr>
						<th colspan="3">CCT</th>
						<th colspan="3">Nombre de la escuela</th>
						<th colspan="3">Status</th>
						<th colspan="3">Avance</th>
					</tr>
				</thead>
				<tbody>
					<tr>
						<td colspan="3">{{escuela.username}}</td>
						<td colspan="3">{{perfil.tipo}} {{perfil.nivel_educativo}} "{{escuela.get_full_name}}"</td>
						<td colspan="3">{%if perfil.status%}{{perfil.status}}{%else%}Pendiente{%endif%}</td>
						<td colspan="3">{%if perfil.avance%}{{perfil.avance}}%{%endif%}</td>
					</tr>
				</tbody>
				<thead>
					<tr>
						<th colspan="3">Turno</th>
						<th colspan="3">Matricula</th>
						<th colspan="3">Director</th>
						<th colspan="3">Foto</th>
					</tr>
				</thead>
				<tbody>
					<tr>
						<td colspan="3">{{perfil.turno}}</td>
						<td colspan="3">{{perfil.plantilla_escolar}}</td>
						<td colspan="3">{{perfil.director}}</td>
						<td colspan="3">{%if perfil.foto_director%}<a href="{{perfil.foto_director.url}}">Ver</a>{%else%}Nota: Subir foto del Director{%endif%}</td>
					</tr>
				</tbody>
				<thead>
					<tr>
						<th colspan="3">Telefono</th>
						<th colspan="3">Mail</th>
						<th colspan="3">Domicilio</th>
						<th colspan="3">Referencias</th>
					</tr>
				</thead>
				<tbody>
					<tr>
						<td colspan="3">{{perfil.telefono}}</td>
						<td colspan="3">{{escuela.email}}</td>
						<td colspan="3">{{perfil.domicilio}}</td>
						<td colspan="3">{{perfil.referencias}}</td>
					</tr>
				</tbody>
				<thead>
					<tr>
						<th colspan="3">Municipio</th>
						<th colspan="3">Zona</th>
						<th colspan="3">Partida/Estado</th>
						<th colspan="3">Región</th>
					</tr>
				</thead>
				<tbody>
					<tr>
						<td colspan="3">{{perfil.municipio.nombre}}</td>
						<td colspan="3">{{zona.nombre}}</td>
						<td colspan="3">{{entidad}}</td>
						<td colspan="3">{{region}}</td>
					</tr>
				</tbody>
				<thead>
					<tr>
						<th colspan="4">Aulas existentes</th>
						<th colspan="4">Aulas en uso</th>
						<th colspan="4">Tipo de Conexión</th>
					</tr>
				</thead>
				<tbody>
					<tr>
						<td colspan="4">{{perfil.aulas_existentes}}</td>
						<td colspan="4">{{perfil.aulas_en_uso}}</td>
						<td colspan="4">{{perfil.conexion}}</td>
					</tr>
				</tbody>
			</table>
		</div>
	</div>

	<!-- Tabla de Contactos-->
	<h2>Contactos</h2>

	<div class="row justify-content-center">
		<div class="table-responsive text-center">
			<table class="table table-bordered">
				<thead>
					<tr>
						<th>Coordinador Estatal</th>
						<th>Residente Técnico</th>
						<th>Superintendente</th>
						<th>Ejecutora</th>
					</tr>
				</thead>
				<tbody>
					<tr>
						<td>{{perfil.municipio.zona.entidad.coordinador_estatal.get_full_name}}</td><td>{{perfil.municipio.zona.entidad.residente_tecnico.get_full_name}}</td>
						<td>{{perfil.municipio.zona.entidad.partida.si.get_full_name}}</td>
						<td>{{sistemaBebedero.ejecutora}}</td>
					</tr>
				</tbody>
			</table>
		</div>
	</div>

<h2>Cronología general de la gestión, construcción, instalación y mantenimiento de un sistema bebedero</h2>

<style type="text/css">

.dummy {
    margin-top: 100%;
}
.thumbnail {
    position: absolute;
    top: 0;
    bottom: 0;
    left: 0;
    right: 0;
    text-align:center;

    display: flex;
    align-items: center;
    justify-content: center;
    
    border: solid black 0.5px;
    background-color: #eeeee1;
    color: black;
	}

.thumbnail:hover {
	color: #848484;
}

.thumbnail-inprogress {
background-color: #DFF336;
color: black;
}

.thumbnail-inprogress:hover {
background-color: #D2E532 ;
color: black;
}

.thumbnail-available {
background-color: #44B036;
color: white;
}

.thumbnail-available:hover {
background-color: #197D0E;
color: white;
}

.thumbnail-prueba-en-espera {
background-color: yellow;
color: black;
}

.thumbnail-prueba-en-espera:hover {
background-color: #E5BB31;
color: black;
}

.thumbnail-prueba-aprobado {
background-color: green;
color: white;
}

.thumbnail-prueba-aprobado:hover {
background-color: #006600;
color: white;
}

.thumbnail-prueba-no-aprobado {
background-color: red;
color: white;
}

.thumbnail-prueba-no-aprobado:hover {
background-color: #F00000 ;
color: white;
}
</style>

<div class="row">
	<div class="col-md-3 col-sm-4">
		<div class="dummy"></div>
		<a class="thumbnail thumbnail-available container" href="{%url 'incidencias:ViewIncidencias' perfil.pk%}">Incidencias</a>
	</div>
	<div class="col-md-2 col-sm-4">
		<div class="dummy"></div>
		<a {%if visitaAlSitio%} class="thumbnail thumbnail-available container" {%else%} class="thumbnail container" {%endif%} href="{%url 'visitas:ViewVisitaAlSitio' perfil.pk%}">Visita al sitio</a>
	</div>

	{%if visitaAlSitio%}
	<div class="col-md-2 col-sm-4">
		<div class="dummy"></div>
		<a {%if visitaDeAcuerdo%} class="thumbnail thumbnail-available container" {%else%} class="thumbnail container" {%endif%} href="{%url 'visitas:ViewVisitaDeAcuerdo' perfil.pk%}">Visita de acuerdos</a>
	</div>
	{%endif%}

	{%if visitaDeAcuerdo%}
	<div class="col-md-2 col-sm-6">
		<div class="dummy"></div>
		<a {%if primerPrueba%} class="thumbnail thumbnail-available container" {%else%} class="thumbnail container" {%endif%} href="{%url 'pruebas:ViewPrimerPrueba' perfil.pk%}">Primer prueba de calidad</a>
	</div>
	{%endif%}

	{%if primerPrueba%}
	<div class="col-md-3 col-sm-6">
		<div class="dummy"></div>
		<div {%if primerPrueba.aprobacion == "En espera"%} class=" thumbnail container thumbnail-prueba-en-espera" {%elif primerPrueba.aprobacion == "No aprobado"%} class=" thumbnail container thumbnail-prueba-no-aprobado" {%elif primerPrueba.aprobacion == "Aprobado"%} class=" thumbnail container thumbnail-prueba-aprobado" {%endif%}>Veredicto de Prueba de Calidad de Agua: {{primerPrueba.aprobacion}}</div>
	</div>
	{%endif%}
	{%if primerPrueba.aprobacion == "Aprobado"%}
	<div class="col-md-2 col-sm-4">
		<div class="dummy"></div>
		<a {%if sistemaBebedero%} class="thumbnail thumbnail-available container" {%else%} class="thumbnail container" {%endif%} href="{%url 'bebederos:ViewBebederos' perfil.pk%}"> Asignación de componentes del Sistema bebedero</a>
	</div>
	{%endif%}
	{%if sistemaBebedero%}
	<div class="col-md-2 col-sm-4">
		<div class="dummy"></div>
		<a {%if inicioDeTrabajo%} class="thumbnail thumbnail-available container" {%else%} class="thumbnail container" {%endif%} href="{%url 'construccion:ViewInicioDeTrabajo' perfil.pk%}">Inicio de trabajos</a>
	</div>
	{%endif%}

	{%if inicioDeTrabajo%}
	<div class="col-md-2 col-sm-4">
		<div class="dummy"></div>
		<a {%if instalacionBebedero%} class="thumbnail thumbnail-available container" {%else%} class="thumbnail container" {%endif%} href="{%url 'construccion:ViewInstalacionBebedero' perfil.pk%}">Instalación de bebedero</a>
	</div>
	{%endif%}
	
	{%if instalacionBebedero%}
	<div class="col-md-3 col-sm-6">
		<div class="dummy"></div>
		<a {%if evidenciasConstruccion%} class="thumbnail thumbnail-available container" {%else%} class="thumbnail container" {%endif%} href="{%url 'construccion:ViewBitacora' perfil.pk%}">Bitacora</a>
	</div>
	{%endif%}

	{%if evidenciasConstruccion%}
	<div class="col-md-3 col-sm-6">
		<div class="dummy"></div>
		<div {%if evidenciaFinal%} class="thumbnail thumbnail-prueba-aprobado container" {%else%} class="thumbnail thumbnail-prueba-en-espera" {%endif%}>{%if evidenciaFinal%}Construcción finalizada{%else%}En proceso de construción o revisión{%endif%}</div>
	</div>
	{%endif%}

	{%if evidenciaFinal%}

	<div class="col-md-2 col-sm-3">
		<div class="dummy"></div>
		<a {%if evidenciaFinal%} class="thumbnail thumbnail-available container" {%else%} class="thumbnail container" {%endif%} href="{%url 'construccion:ViewTerminoDeTrabajo' perfil.pk%}">Termino de trabajos</a>
	</div>

	{%endif%}


	{%if terminoDeTrabajo%}
	<div class="col-md-2 col-sm-3">
		<div class="dummy"></div>
		<a {%if segundaPrueba%} class="thumbnail thumbnail-available container" {%else%} class="thumbnail container" {%endif%} href="{%url 'pruebas:ViewSegundaPrueba' perfil.pk%}">Segunda prueba de calidad</a>
	</div>
	{%endif%}

	{%if segundaPrueba%}
	<div class="col-md-3 col-sm-6">
		<div class="dummy"></div>
		<div {%if segundaPrueba.aprobacion == "En espera"%} class=" thumbnail container thumbnail-prueba-en-espera" {%elif segundaPrueba.aprobacion == "No aprobado"%} class=" thumbnail container thumbnail-prueba-no-aprobado" {%elif segundaPrueba.aprobacion == "Aprobado"%} class=" thumbnail container thumbnail-prueba-aprobado" {%endif%}>Veredicto de Prueba de Calidad de Agua: {{segundaPrueba.aprobacion}}</div>
	</div>
	{%endif%}

		{%if segundaPrueba.aprobacion == "Aprobado"%}
	<div class="col-md-2 col-sm-6">
		<div class="dummy"></div>
		<a {%if entregaDeBebedero%} class="thumbnail thumbnail-available container" {%else%} class="thumbnail container" {%endif%} href="{%url 'visitas:ViewEntregaDeBebedero' perfil.pk%}"> Entrega de Bebedero</a>
	</div>
	{%endif%}


	{%if entregaDeBebedero%}
	<div class="col-md-3 col-sm-6">
		<div class="dummy"></div>
		<a {%if mantenimientos.count == 24%} class="thumbnail thumbnail-available container"{%elif mantenimientos.count > 0 and mantenimientos.count < 24%} class="thumbnail thumbnail-prueba-en-espera container" {%elif mantenimientos.count == 0%} class="thumbnail container"{%endif%} href="{%url 'mantenimiento:ViewMantenimientos' perfil.pk%}">Mantenimientos <br> {%if mantenimientos.count != 0%}Cantidad: {{mantenimientos.count}}{%endif%}</a>
	</div>
	{%endif%}

</div>

{%endblock content%}