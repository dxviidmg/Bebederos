{%extends 'base.html'%}

{% load bootstrap %}

{%block content%}

	<div>
		<h1>Información general de la {{perfil.tipo}} {{perfil.nivel_educativo}} {{escuela.get_full_name}}</h1>

		<h2>Status: {{perfil.status}}</h2>
		<h3>Avance: {{perfil.avance}}%</h3>
		<p>CCT: {{escuela.username}}</p>
		<p>Turno: {{perfil.turno}}</p>
		<p>Director: {{perfil.director}}</p>
		{%if perfil.foto_director%}
		<p>Foto del director: <a href="{{perfil.foto_director.url}}">Ver</a></p>
		{%endif%}
		<p>Cantidad de alumnos: {{perfil.plantilla_escolar}}</p>
		<p>Telefono: {{perfil.telefono}}</p>
		<p>Domicilio: {{perfil.domicilio}}</p>
		<p>Referencias: {{perfil.referencias}}</p>
		
		<p>Aulas existentes: {{perfil.aulas_existentes}}</p>
		<p>Aulas en uso: {{perfil.aulas_en_uso}}</p>
	</div>
	<div>
		<h2>Cronologia general de la gestión, construcción, instalación y mantetimiento de un bebedero</h2>
		
		<br>
		
	</div>
	<div class="table-responsive text-center">
		<table class="table table-bordered">
			<tbody style="background-color: #BDBDBD;">

			{%if request.user.perfil.tipo == "SIM" or request.user.perfil.tipo == "INIFED"%}
				<tr>
					<td colspan="4" style="background-color: red;"><a href="{%url 'incidencias:ViewIncidencias' perfil.pk%}">Incidencias</a>
				</tr>
				<tr>
					<td colspan="4">Formalidades</td>
				</tr>
				<tr style="background-color: #0080FF;">
					<td colspan="2"><a href="{%url 'visitas:ViewVisitaAlSitio' perfil.pk%}">Visita al sitio</a></td>

			{%endif%}

{%if visitaAlSitio%}
			{%if request.user.perfil.tipo == "SIM"  or request.user.perfil.tipo == "INIFED"%}
					<td colspan="2"><a href="{%url 'visitas:ViewVisitaDeAcuerdo' perfil.pk%}">Visita de acuerdos</a></td>
				</tr>
			{%endif%}
	{%if visitaDeAcuerdo%}	

			{%if request.user.perfil.tipo == "Laboratorio" or request.user.perfil.tipo == "SIM"  or request.user.perfil.tipo == "INIFED"%}		
				<tr>
					<td colspan="4">Pruebas de calidad de agua</td>
				</tr>

			
				<tr style="background-color: orange;">
					<td colspan="4">
						<a href="{%url 'pruebas:ViewPrimerPrueba' perfil.pk%}">Primer prueba de calidad</a>
					</td>
				</tr>

			{%endif%}
		
		{%if primerPrueba.aprobacion == "En espera"%}

			{%if request.user.perfil.tipo == "Laboratorio" or request.user.perfil.tipo == "SIM" or request.user.perfil.tipo == "INIFED"%}

				<tr style="background-color: yellow;">
					<td colspan="4">Status: Esperando resultados</td>
				</tr>

			{%endif%}

		{%elif primerPrueba.aprobacion == "No aprobado"%}

			{%if request.user.perfil.tipo == "Laboratorio" or request.user.perfil.tipo == "SIM" or request.user.perfil.tipo == "INIFED"%}
				<tr style="background-color: red;">
					<td colspan="4">Status: No aprobado</td>
				</tr>

			{%endif%}

		{%elif primerPrueba.aprobacion == "Aprobado"%}

			{%if request.user.perfil.tipo == "Laboratorio" or request.user.perfil.tipo == "SIM" or request.user.perfil.tipo == "INIFED"%}

				<tr style="background-color: green;">
					<td colspan="4">Status: Aprobado</td>
				</tr>
			{%endif%}

			{%if request.user.perfil.tipo == "SIM" or request.user.perfil.tipo == "Ejecutora" or request.user.perfil.tipo == "INIFED"%}

				<tr>
					<td colspan="4">Trabajos</td>
				</tr>

			{%endif%}

			{%if request.user.perfil.tipo == "SIM" or request.user.perfil.tipo == "INIFED"%}	
				<tr style="background-color: #FFFF00;">
					<td colspan="1"><a href="{%url 'construccion:ViewInicioDeTrabajo' perfil.pk%}">Inicio de trabajos</a></td>

			{%endif%}

			{%if inicioDeTrabajo%}

			{%if request.user.perfil.tipo == "SIM" or request.user.perfil.tipo == "INIFED"%}

					<td colspan="1"><a href="{%url 'construccion:ViewInstalacionBebedero' perfil.pk%}">Instalación de bebedero</a></td>
			{%endif%}

			{%if request.user.perfil.tipo == "SIM" or request.user.perfil.tipo == "Ejecutora" or request.user.perfil.tipo == "INIFED"%}	
					<td colspan="1"><a href="{%url 'construccion:ViewBitacora' perfil.pk%}">Bitacora</a></td>

			{%endif%}

				{%if instalacionBebedero%}

			{%if request.user.perfil.tipo == "SIM" or request.user.perfil.tipo == "INIFED"%}

					<td colspan="1"><a href="{%url 'construccion:ViewTerminoDeTrabajo' perfil.pk%}">Termino de trabajos</a></td>
				</tr>

			{%endif%}

					{%if terminoDeTrabajo%} 

			{%if request.user.perfil.tipo == "Laboratorio" or request.user.perfil.tipo == "SIM" or request.user.perfil.tipo == "INIFED"%}

				<tr>
					<td colspan="4">
						Pruebas de calidad de agua
					</td>
				</tr>

				<tr style="background-color: orange;">
					<td colspan="4"><a href="{%url 'pruebas:ViewSegundaPrueba' perfil.pk%}">Segunda prueba de calidad</a>
					</td>

			{%endif%}

				</tr>
						{%if segundaPrueba.aprobacion == "En espera"%}

			{%if request.user.perfil.tipo == "Laboratorio" or request.user.perfil.tipo == "SIM" or request.user.perfil.tipo == "INIFED"%}

						<tr style="background-color: yellow">
							<td colspan="4">Esperando resultados</td>
						</tr>

			{%endif%}
						{%elif segundaPrueba.aprobacion == "No aprobado"%}

			{%if request.user.perfil.tipo == "Laboratorio" or request.user.perfil.tipo == "SIM" or request.user.perfil.tipo == "INIFED"%}
						<tr style="background-color: red">
							<td colspan="4">No paso</td>
						</tr>

			{%endif%}
						{%elif segundaPrueba.aprobacion == "Aprobado"%}

			{%if request.user.perfil.tipo == "Laboratorio" or request.user.perfil.tipo == "SIM" or request.user.perfil.tipo == "INIFED"%}
						<tr style="background-color: green">
							<td colspan="4">Aprobado</td>
						</tr>
			{%endif%}
			{%if request.user.perfil.tipo == "SIM"  or request.user.perfil.tipo == "INIFED"%}

						<tr>
							<td colspan="4">Entrega de bebedero</td>
						</tr>
						<tr style="background-color: #00FF00">
							<td colspan="2"><a href="{%url 'visitas:ViewEntregaDeBebedero' perfil.pk%}">Entrega de bebedero</a></td>

			{%endif%}
							{%if entregaDeBebedero%}

			{%if request.user.perfil.tipo == "SIM" or request.user.perfil.tipo == "INIFED"%}

							<td colspan="2"><a href="">Mantenimiento</a></td>
			{%endif%}
							{%endif%}

						</tr>
						{%endif%}
					{%endif%}
				{%endif%}
			{%endif%}
		{%endif%}				
	{%endif%}
{%endif%}

			</tbody>
		</table>
	</div>

	{{request.user.perfil.tipo}}
{%endblock content%}